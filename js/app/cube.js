define(["require","jquery","app/configurator"],function(e){var t=e("jquery"),n=e("app/configurator"),r=!0,i=0,s=0,o=0,u=0,a=5,f=["rgba(105, 210, 231, 0.3)","rgba(167, 219, 216, 0.3)","rgba(224, 228, 204, 0.3)","rgba(243, 134, 48, 0.3)","rgba(250, 105, 0, 0.3)"],l=[],c="rotateX(${xAngle}deg) rotateY(${yAngle}deg) rotateZ(${zAngle}deg)",h=function(){return f.slice()},p=function(){var e=!r;e?d():v()},d=function(){r=!0,t("a.play-mode").html("stop"),t("#cube").on("webkitTransitionEnd",w),w()},v=function(){r=!1,t("a.play-mode").html("play"),t("#cube").off("webkitTransitionEnd",w)},m=function(){return i===0&&s===0&&o===0},g=function(e,t,n){return e!==i||t!==s||n!==o},y=function(){l.length||(l=h()),t("body").css("background-color",l.pop())},b=function(e,n,r){var f;i=e,s=n,o=r,f=c.replace("${xAngle}",i).replace("${yAngle}",s).replace("${zAngle}",o),t("#cube").css("webkitTransform",f),u+=1,u%a===0&&y()},w=function(){var e=E(),t=E(),n=E();g(e,t,n)?b(e,t,n):w()},E=function(){return x(0,90)*S()},S=function(){return x(-1,1)},x=function(e,t){return Math.random()<.5?e:t};t(function(){var e=38,u=40,a=37,f=39,l=65,c=83,h=32,m={"#slow":2,"#normal":1,"#fast":.4,"#intense":30,"#mild":800,"#flat":1e5,"#tiny":20,"#regular":200,"#huge":2e3},y=function(e){var t=e.attr("href");return m[t]},w=function(e){e.preventDefault(),e.stopPropagation()};r?d():v(),t("a.play-mode").click(function(e){w(e),p()}),t("a.speed").click(function(e){w(e),n.setSpeed(y(t(this)))}),t("a.perspective").click(function(e){w(e),n.setPerspective(y(t(this)))}),t("a.size").click(function(e){w(e),n.setSize(y(t(this)))}),t("a.shape").click(function(e){w(e),t(this).html(n.toggleRounded()?"Squared":"Rounded")}),t("a.translation").click(function(e){w(e),t(this).html(n.toggleTrans()?"Tidy":"Loose")}),t("a.border").click(function(e){w(e),t(this).html(n.toggleBorder()?"Without border":"With border")}),t("body").keydown(function(t){var n=i,d=s,m=o,y=t.keyCode;if(y===h)p();else{switch(y){case e:n-=90;break;case u:n+=90;break;case a:d+=90;break;case f:d-=90;break;case l:m+=90;break;case c:m-=90}g(n,d,m)&&(r&&v(),b(n,d,m))}})})})